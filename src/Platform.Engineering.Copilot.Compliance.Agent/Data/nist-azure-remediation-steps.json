{
  "version": "1.0",
  "framework": "NIST-800-53-R5",
  "platform": "Azure",
  "lastUpdated": "2025-11-26",
  "controls": {
    "AC-2": {
      "controlId": "AC-2",
      "priority": "High",
      "estimatedEffort": "PT15M",
      "isAutomated": true,
      "steps": [
        {
          "order": 1,
          "description": "Create Azure AD application",
          "command": "az ad app create --display-name <app-name>"
        },
        {
          "order": 2,
          "description": "Assign role",
          "command": "az role assignment create --assignee <app-id> --role Contributor --scope <scope>"
        }
      ],
      "validationSteps": [
        "Verify account created",
        "Confirm role assignment",
        "Test authentication"
      ],
      "applicableResourceTypes": [
        "Microsoft.Web/sites",
        "Microsoft.Compute/virtualMachines",
        "Microsoft.AAD/tenants"
      ],
      "availableActions": [
        {
          "action": "Enable Azure AD authentication",
          "description": "Configure Azure AD authentication for the resource",
          "risk": "Low",
          "estimatedMinutes": 15,
          "prerequisites": ["Azure AD tenant", "Contributor access"]
        }
      ]
    },
    "AC-3": {
      "controlId": "AC-3",
      "priority": "High",
      "estimatedEffort": "PT20M",
      "isAutomated": true,
      "steps": [
        {
          "order": 1,
          "description": "Review current role assignments",
          "command": "az role assignment list --all --query \"[?principalType=='User']\" --output table"
        },
        {
          "order": 2,
          "description": "Apply least privilege principle",
          "command": "az role assignment create --assignee <user-id> --role Reader --scope <scope>"
        }
      ],
      "validationSteps": [
        "Verify access restrictions",
        "Test user permissions"
      ],
      "applicableResourceTypes": ["*"],
      "availableActions": []
    },
    "AC-6": {
      "controlId": "AC-6",
      "priority": "High",
      "estimatedEffort": "PT30M",
      "isAutomated": true,
      "steps": [
        {
          "order": 1,
          "description": "Audit privileged roles",
          "command": "az role assignment list --all --query \"[?roleDefinitionName=='Owner' || roleDefinitionName=='Contributor']\""
        },
        {
          "order": 2,
          "description": "Remove excessive permissions",
          "command": "az role assignment delete --assignee <user-id> --role <role-name> --scope <scope>"
        }
      ],
      "validationSteps": [
        "Confirm reduced permissions",
        "Verify application still functions"
      ],
      "applicableResourceTypes": ["*"],
      "availableActions": []
    },
    "AC-17": {
      "controlId": "AC-17",
      "priority": "Critical",
      "estimatedEffort": "PT45M",
      "isAutomated": false,
      "steps": [
        {
          "order": 1,
          "description": "Enable Azure AD Conditional Access",
          "command": "# Configure via Azure Portal: Azure AD > Security > Conditional Access"
        },
        {
          "order": 2,
          "description": "Require MFA for remote access",
          "command": "# Create MFA policy for remote access"
        }
      ],
      "validationSteps": [
        "Test remote access with MFA",
        "Verify conditional access policies"
      ],
      "applicableResourceTypes": ["Microsoft.AAD/tenants"],
      "availableActions": []
    },
    "AU-2": {
      "controlId": "AU-2",
      "priority": "Medium",
      "estimatedEffort": "PT10M",
      "isAutomated": true,
      "steps": [
        {
          "order": 1,
          "description": "Configure diagnostic settings",
          "command": "az monitor diagnostic-settings create --resource <resource-id> --workspace <workspace-id> --logs '[{\"category\":\"AuditEvent\",\"enabled\":true}]'"
        }
      ],
      "validationSteps": [
        "Verify logs flowing to workspace",
        "Check audit event coverage"
      ],
      "applicableResourceTypes": [
        "Microsoft.Web/sites",
        "Microsoft.Storage/storageAccounts",
        "Microsoft.KeyVault/vaults"
      ],
      "availableActions": [
        {
          "action": "Enable diagnostic settings",
          "description": "Configure diagnostic logs to Log Analytics workspace",
          "risk": "Low",
          "estimatedMinutes": 10,
          "prerequisites": ["Log Analytics workspace"]
        }
      ]
    },
    "AU-3": {
      "controlId": "AU-3",
      "priority": "Medium",
      "estimatedEffort": "PT15M",
      "isAutomated": true,
      "steps": [
        {
          "order": 1,
          "description": "Enable detailed logging",
          "command": "az monitor diagnostic-settings update --resource <resource-id> --set logs[0].retentionPolicy.enabled=true logs[0].retentionPolicy.days=90"
        }
      ],
      "validationSteps": [
        "Verify audit record completeness"
      ],
      "applicableResourceTypes": ["*"],
      "availableActions": []
    },
    "AU-6": {
      "controlId": "AU-6",
      "priority": "Medium",
      "estimatedEffort": "PT25M",
      "isAutomated": true,
      "steps": [
        {
          "order": 1,
          "description": "Create Log Analytics workspace query",
          "command": "az monitor log-analytics query --workspace <workspace-id> --analytics-query \"AzureActivity | where TimeGenerated > ago(7d)\""
        },
        {
          "order": 2,
          "description": "Set up alert rules",
          "command": "az monitor metrics alert create --name <alert-name> --resource-group <rg> --scopes <resource-id> --condition \"count > 10\""
        }
      ],
      "validationSteps": [
        "Test alert triggers",
        "Verify review procedures"
      ],
      "applicableResourceTypes": [
        "Microsoft.OperationalInsights/workspaces"
      ],
      "availableActions": []
    },
    "AU-12": {
      "controlId": "AU-12",
      "priority": "Medium",
      "estimatedEffort": "PT20M",
      "isAutomated": true,
      "steps": [
        {
          "order": 1,
          "description": "Enable Activity Log",
          "command": "az monitor activity-log list --resource-group <rg>"
        },
        {
          "order": 2,
          "description": "Configure resource-level logging",
          "command": "az monitor diagnostic-settings create --resource <resource-id> --workspace <workspace-id> --logs '[{\"category\":\"AllLogs\",\"enabled\":true}]'"
        }
      ],
      "validationSteps": [
        "Verify comprehensive audit coverage"
      ],
      "applicableResourceTypes": ["*"],
      "availableActions": []
    },
    "CM-2": {
      "controlId": "CM-2",
      "priority": "Medium",
      "estimatedEffort": "PT30M",
      "isAutomated": true,
      "steps": [
        {
          "order": 1,
          "description": "Export current configuration",
          "command": "az resource show --ids <resource-id> --output json > baseline-config.json"
        },
        {
          "order": 2,
          "description": "Apply Azure Policy for baseline",
          "command": "az policy assignment create --name baseline-enforcement --policy <policy-id> --scope <scope>"
        }
      ],
      "validationSteps": [
        "Verify baseline documented",
        "Confirm policy enforcement"
      ],
      "applicableResourceTypes": ["*"],
      "availableActions": []
    },
    "CM-6": {
      "controlId": "CM-6",
      "priority": "Medium",
      "estimatedEffort": "PT20M",
      "isAutomated": true,
      "steps": [
        {
          "order": 1,
          "description": "Apply security baseline settings",
          "command": "az policy assignment create --name security-baseline --policy-set-definition <baseline-id> --scope <scope>"
        }
      ],
      "validationSteps": [
        "Verify configuration compliance"
      ],
      "applicableResourceTypes": ["*"],
      "availableActions": []
    },
    "CM-7": {
      "controlId": "CM-7",
      "priority": "Low",
      "estimatedEffort": "PT45M",
      "isAutomated": false,
      "steps": [
        {
          "order": 1,
          "description": "Identify unnecessary services",
          "command": "az resource list --resource-group <rg> --query \"[?tags.Environment=='unused']\""
        },
        {
          "order": 2,
          "description": "Disable/remove unused features",
          "command": "# Review and disable unnecessary Azure services"
        }
      ],
      "validationSteps": [
        "Verify only required services enabled"
      ],
      "applicableResourceTypes": ["*"],
      "availableActions": []
    },
    "IA-2": {
      "controlId": "IA-2",
      "priority": "Critical",
      "estimatedEffort": "PT20M",
      "isAutomated": true,
      "steps": [
        {
          "order": 1,
          "description": "Enforce Azure AD authentication",
          "command": "az webapp auth update --resource-group <rg> --name <app-name> --enabled true --action LoginWithAzureActiveDirectory"
        },
        {
          "order": 2,
          "description": "Disable local authentication",
          "command": "az webapp config set --resource-group <rg> --name <app-name> --ftps-state Disabled"
        }
      ],
      "validationSteps": [
        "Test authentication flow",
        "Verify no anonymous access"
      ],
      "applicableResourceTypes": [
        "Microsoft.Web/sites",
        "Microsoft.Sql/servers"
      ],
      "availableActions": []
    },
    "IA-5": {
      "controlId": "IA-5",
      "priority": "High",
      "estimatedEffort": "PT30M",
      "isAutomated": false,
      "steps": [
        {
          "order": 1,
          "description": "Enable Azure AD Password Protection",
          "command": "# Configure via Azure AD > Security > Authentication methods"
        },
        {
          "order": 2,
          "description": "Set password complexity policy",
          "command": "# Configure password policy in Azure AD"
        }
      ],
      "validationSteps": [
        "Verify password policy enforcement"
      ],
      "applicableResourceTypes": ["Microsoft.AAD/tenants"],
      "availableActions": []
    },
    "SC-7": {
      "controlId": "SC-7",
      "priority": "Critical",
      "estimatedEffort": "PT30M",
      "isAutomated": true,
      "steps": [
        {
          "order": 1,
          "description": "Create Network Security Group",
          "command": "az network nsg create --resource-group <rg> --name <nsg-name> --location <location>"
        },
        {
          "order": 2,
          "description": "Create deny-all inbound rule",
          "command": "az network nsg rule create --nsg-name <nsg-name> --resource-group <rg> --name DenyAllInbound --priority 4096 --direction Inbound --access Deny"
        },
        {
          "order": 3,
          "description": "Create allow rules for required ports",
          "command": "az network nsg rule create --nsg-name <nsg-name> --resource-group <rg> --name AllowHTTPS --priority 100 --destination-port-ranges 443 --access Allow"
        }
      ],
      "validationSteps": [
        "Test network connectivity",
        "Verify no unauthorized ports open",
        "Confirm deny-all baseline"
      ],
      "applicableResourceTypes": [
        "Microsoft.Network/networkSecurityGroups",
        "Microsoft.Compute/virtualMachines"
      ],
      "availableActions": [
        {
          "action": "Configure Network Security Group",
          "description": "Create NSG rules to restrict network access",
          "risk": "Medium",
          "estimatedMinutes": 30,
          "prerequisites": ["Network Contributor role"]
        },
        {
          "action": "Enable Azure Firewall",
          "description": "Deploy Azure Firewall for advanced network protection",
          "risk": "High",
          "estimatedMinutes": 120,
          "prerequisites": ["Firewall subnet", "Public IP"]
        }
      ]
    },
    "SC-8": {
      "controlId": "SC-8",
      "priority": "Critical",
      "estimatedEffort": "PT15M",
      "isAutomated": true,
      "steps": [
        {
          "order": 1,
          "description": "Enforce HTTPS only",
          "command": "az webapp update --resource-group <rg> --name <app-name> --set httpsOnly=true"
        },
        {
          "order": 2,
          "description": "Set minimum TLS version",
          "command": "az webapp config set --resource-group <rg> --name <app-name> --min-tls-version 1.2"
        }
      ],
      "validationSteps": [
        "Test HTTPS enforcement",
        "Verify TLS version"
      ],
      "applicableResourceTypes": [
        "Microsoft.Web/sites",
        "Microsoft.Storage/storageAccounts"
      ],
      "availableActions": []
    },
    "SC-12": {
      "controlId": "SC-12",
      "priority": "Critical",
      "estimatedEffort": "PT25M",
      "isAutomated": true,
      "steps": [
        {
          "order": 1,
          "description": "Create Azure Key Vault",
          "command": "az keyvault create --name <vault-name> --resource-group <rg> --location <location> --enable-purge-protection true"
        },
        {
          "order": 2,
          "description": "Enable soft delete",
          "command": "az keyvault update --name <vault-name> --enable-soft-delete true --retention-days 90"
        }
      ],
      "validationSteps": [
        "Verify Key Vault created",
        "Test key operations",
        "Confirm purge protection enabled"
      ],
      "applicableResourceTypes": [
        "Microsoft.KeyVault/vaults"
      ],
      "availableActions": []
    },
    "SC-13": {
      "controlId": "SC-13",
      "priority": "Critical",
      "estimatedEffort": "PT20M",
      "isAutomated": true,
      "steps": [
        {
          "order": 1,
          "description": "Enable encryption at rest",
          "command": "az storage account update --resource-group <rg> --name <storage-account> --encryption-services blob"
        },
        {
          "order": 2,
          "description": "Enable infrastructure encryption",
          "command": "az storage account update --resource-group <rg> --name <storage-account> --require-infrastructure-encryption"
        }
      ],
      "validationSteps": [
        "Verify encryption enabled",
        "Check encryption keys"
      ],
      "applicableResourceTypes": [
        "Microsoft.Storage/storageAccounts"
      ],
      "availableActions": []
    },
    "SC-28": {
      "controlId": "SC-28",
      "priority": "Critical",
      "estimatedEffort": "PT40M",
      "isAutomated": true,
      "steps": [
        {
          "order": 1,
          "description": "Enable Azure Disk Encryption",
          "command": "az vm encryption enable --resource-group <rg> --name <vm-name> --disk-encryption-keyvault <vault-name>"
        },
        {
          "order": 2,
          "description": "Verify encryption status",
          "command": "az vm encryption show --resource-group <rg> --name <vm-name>"
        }
      ],
      "validationSteps": [
        "Confirm disk encryption active",
        "Verify no unencrypted volumes"
      ],
      "applicableResourceTypes": [
        "Microsoft.Compute/virtualMachines",
        "Microsoft.Compute/disks"
      ],
      "availableActions": []
    },
    "SI-2": {
      "controlId": "SI-2",
      "priority": "High",
      "estimatedEffort": "PT30M",
      "isAutomated": true,
      "steps": [
        {
          "order": 1,
          "description": "Enable automatic updates",
          "command": "az vm auto-patching update --resource-group <rg> --name <vm-name> --enable true"
        },
        {
          "order": 2,
          "description": "Configure update schedule",
          "command": "# Configure maintenance window via Azure Portal"
        }
      ],
      "validationSteps": [
        "Verify patch management enabled"
      ],
      "applicableResourceTypes": [
        "Microsoft.Compute/virtualMachines"
      ],
      "availableActions": []
    },
    "SI-3": {
      "controlId": "SI-3",
      "priority": "Critical",
      "estimatedEffort": "PT25M",
      "isAutomated": true,
      "steps": [
        {
          "order": 1,
          "description": "Enable Microsoft Defender for Cloud",
          "command": "az security pricing create --name VirtualMachines --tier Standard"
        },
        {
          "order": 2,
          "description": "Enable antimalware extension",
          "command": "az vm extension set --resource-group <rg> --vm-name <vm-name> --name IaaSAntimalware --publisher Microsoft.Azure.Security"
        }
      ],
      "validationSteps": [
        "Verify Defender enabled",
        "Check antimalware status"
      ],
      "applicableResourceTypes": [
        "Microsoft.Compute/virtualMachines",
        "Microsoft.Security/pricings"
      ],
      "availableActions": []
    },
    "SI-4": {
      "controlId": "SI-4",
      "priority": "High",
      "estimatedEffort": "PT35M",
      "isAutomated": true,
      "steps": [
        {
          "order": 1,
          "description": "Enable Azure Monitor",
          "command": "az monitor diagnostic-settings create --resource <resource-id> --workspace <workspace-id> --metrics '[{\"category\":\"AllMetrics\",\"enabled\":true}]'"
        },
        {
          "order": 2,
          "description": "Configure alerts",
          "command": "az monitor metrics alert create --name <alert-name> --resource-group <rg> --scopes <resource-id> --description 'Monitor for anomalies'"
        }
      ],
      "validationSteps": [
        "Verify monitoring active",
        "Test alert notifications"
      ],
      "applicableResourceTypes": ["*"],
      "availableActions": []
    }
  }
}
